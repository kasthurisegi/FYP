{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { createContext, useEffect, useState, useReducer, useContext, useRef } from \"react\";\nimport { auth, db } from \"../../FirebaseConfig\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { doc, getDoc, onSnapshot, collection, query, where } from \"firebase/firestore\";\nimport { UserInfoContext } from \"./userInfoContext\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var DataProcessorContext = createContext();\nexport var DataProcessorContextProvider = function DataProcessorContextProvider(_ref) {\n  var children = _ref.children;\n  var _useContext = useContext(UserInfoContext),\n    userID = _useContext.userID;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    currentUser = _useState2[0],\n    setCurrentUser = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    roommate = _useState4[0],\n    setRoommate = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    room = _useState6[0],\n    setRoom = _useState6[1];\n  var _useState7 = useState(null),\n    _useState8 = _slicedToArray(_useState7, 2),\n    favorite = _useState8[0],\n    setFavorite = _useState8[1];\n  var _useState9 = useState(null),\n    _useState10 = _slicedToArray(_useState9, 2),\n    favoriteRoom = _useState10[0],\n    setFavoriteRoom = _useState10[1];\n  useEffect(function () {\n    if (userID) {\n      var unsub = onSnapshot(doc(db, \"users\", userID), function (doc) {\n        setCurrentUser(doc.data());\n        return;\n      });\n      var q = query(collection(db, \"favorite\"), where(\"userID\", \"==\", userID));\n      var unsubscribeFavorite = onSnapshot(q, function (querySnapshot) {\n        var favorites = [];\n        querySnapshot.forEach(function (doc) {\n          favorites.push(doc.data());\n        });\n        setFavorite(favorites);\n      });\n      var q1 = query(collection(db, \"favoriteRoom\"), where(\"userID\", \"==\", userID));\n      var unsubscribeRoomFavorite = onSnapshot(q1, function (querySnapshot) {\n        var favoritesRoom = [];\n        querySnapshot.forEach(function (doc) {\n          favoritesRoom.push(doc.data());\n        });\n        setFavoriteRoom(favoritesRoom);\n      });\n      return function () {\n        unsub, unsubscribeFavorite, unsubscribeRoomFavorite;\n      };\n    }\n  }, [userID]);\n  useEffect(function () {\n    var q = query(collection(db, \"roommates\"), where(\"roommateID\", \"!=\", \"\"));\n    var unsubscribeRoommate = onSnapshot(q, function (querySnapshot) {\n      var roommates = [];\n      querySnapshot.forEach(function (doc) {\n        roommates.push(doc.data());\n      });\n      setRoommate(roommates);\n    });\n    var q1 = query(collection(db, \"room\"), where(\"roomID\", \"!=\", \"\"));\n    var unsubscribeRoom = onSnapshot(q1, function (querySnapshot) {\n      var room = [];\n      querySnapshot.forEach(function (doc) {\n        room.push(doc.data());\n      });\n      setRoom(room);\n    });\n    return function () {\n      unsubscribeRoommate, unsubscribeRoom;\n    };\n  }, []);\n  var INITIAL_SELECTED_ROOMMATE = null;\n  var selectRoommateReducer = function selectRoommateReducer(state, action) {\n    switch (action.type) {\n      case \"CHANGE_ROOMMATE\":\n        return action.payload;\n    }\n    ;\n  };\n  var _useReducer = useReducer(selectRoommateReducer, INITIAL_SELECTED_ROOMMATE),\n    _useReducer2 = _slicedToArray(_useReducer, 2),\n    selectedRoommate = _useReducer2[0],\n    dispatchSelectRoommate = _useReducer2[1];\n  var INITIAL_SELECTED_ROOM = null;\n  var selectRoomReducer = function selectRoomReducer(state, action) {\n    switch (action.type) {\n      case \"CHANGE_ROOM\":\n        return action.payload;\n    }\n    ;\n  };\n  var _useReducer3 = useReducer(selectRoomReducer, INITIAL_SELECTED_ROOM),\n    _useReducer4 = _slicedToArray(_useReducer3, 2),\n    selectedRoom = _useReducer4[0],\n    dispatchSelectRoom = _useReducer4[1];\n  return _jsx(DataProcessorContext.Provider, {\n    value: {\n      currentUser: currentUser,\n      roommate: roommate,\n      selectedRoommate: selectedRoommate,\n      dispatchSelectRoommate: dispatchSelectRoommate,\n      favorite: favorite,\n      room: room,\n      selectedRoom: selectedRoom,\n      dispatchSelectRoom: dispatchSelectRoom,\n      favoriteRoom: favoriteRoom\n    },\n    children: children\n  });\n};","map":{"version":3,"names":["React","createContext","useEffect","useState","useReducer","useContext","useRef","auth","db","onAuthStateChanged","doc","getDoc","onSnapshot","collection","query","where","UserInfoContext","DataProcessorContext","DataProcessorContextProvider","children","userID","currentUser","setCurrentUser","roommate","setRoommate","room","setRoom","favorite","setFavorite","favoriteRoom","setFavoriteRoom","unsub","data","q","unsubscribeFavorite","querySnapshot","favorites","forEach","push","q1","unsubscribeRoomFavorite","favoritesRoom","unsubscribeRoommate","roommates","unsubscribeRoom","INITIAL_SELECTED_ROOMMATE","selectRoommateReducer","state","action","type","payload","selectedRoommate","dispatchSelectRoommate","INITIAL_SELECTED_ROOM","selectRoomReducer","selectedRoom","dispatchSelectRoom"],"sources":["C:/Users/kasthuri/Desktop/Roomarch/FYP/src/context/DataProcessor.js"],"sourcesContent":["\r\nimport React, { createContext, useEffect, useState, useReducer, useContext, useRef } from \"react\";\r\nimport { auth, db } from \"../../FirebaseConfig\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { doc, getDoc, onSnapshot, collection, query, where } from \"firebase/firestore\";\r\nimport { UserInfoContext } from \"./userInfoContext\";\r\n\r\nexport const DataProcessorContext = createContext();\r\n\r\nexport const DataProcessorContextProvider = ({ children }) => {\r\n\r\n    const { userID } = useContext(UserInfoContext);\r\n    const [currentUser, setCurrentUser] = useState(null);\r\n    const [roommate, setRoommate] = useState(null);\r\n    const [room, setRoom] = useState(null);\r\n    const [favorite, setFavorite] = useState(null);\r\n    const [favoriteRoom, setFavoriteRoom] = useState(null);\r\n\r\n    useEffect(() => {\r\n\r\n        if(userID){\r\n            const unsub = onSnapshot(doc(db, \"users\", userID), (doc) => {\r\n                setCurrentUser(doc.data())\r\n                return;\r\n            });\r\n\r\n            const q = query(collection(db, \"favorite\"), where(\"userID\", \"==\", userID));\r\n            const unsubscribeFavorite = onSnapshot(q, (querySnapshot) => {\r\n            const favorites = [];\r\n            querySnapshot.forEach((doc) => {\r\n                favorites.push(doc.data());\r\n            });\r\n            setFavorite(favorites)\r\n            });\r\n\r\n            const q1 = query(collection(db, \"favoriteRoom\"), where(\"userID\", \"==\", userID));\r\n            const unsubscribeRoomFavorite = onSnapshot(q1, (querySnapshot) => {\r\n            const favoritesRoom = [];\r\n            querySnapshot.forEach((doc) => {\r\n                favoritesRoom.push(doc.data());\r\n            });\r\n            setFavoriteRoom(favoritesRoom)\r\n            });\r\n\r\n            return () => {\r\n                unsub,\r\n                unsubscribeFavorite,\r\n                unsubscribeRoomFavorite\r\n            }\r\n        }\r\n\r\n    },[userID]);\r\n\r\n    useEffect(() => {\r\n\r\n        const q = query(collection(db, \"roommates\"), where(\"roommateID\", \"!=\", \"\"));\r\n        const unsubscribeRoommate = onSnapshot(q, (querySnapshot) => {\r\n        const roommates = [];\r\n        querySnapshot.forEach((doc) => {\r\n            roommates.push(doc.data());\r\n        });\r\n        setRoommate(roommates)\r\n        });\r\n\r\n        const q1 = query(collection(db, \"room\"), where(\"roomID\", \"!=\", \"\"));\r\n        const unsubscribeRoom = onSnapshot(q1, (querySnapshot) => {\r\n        const room = [];\r\n        querySnapshot.forEach((doc) => {\r\n            room.push(doc.data());\r\n        });\r\n        setRoom(room)\r\n        });\r\n\r\n        return () => {\r\n            unsubscribeRoommate,\r\n            unsubscribeRoom\r\n        }\r\n\r\n    },[]);\r\n\r\n    const INITIAL_SELECTED_ROOMMATE = null;\r\n\r\n    const selectRoommateReducer = (state, action) => {\r\n        switch(action.type){\r\n            case \"CHANGE_ROOMMATE\":\r\n                return action.payload\r\n        };\r\n    };\r\n\r\n    const [selectedRoommate, dispatchSelectRoommate] = useReducer(selectRoommateReducer, INITIAL_SELECTED_ROOMMATE);\r\n\r\n    const INITIAL_SELECTED_ROOM = null;\r\n\r\n    const selectRoomReducer = (state, action) => {\r\n        switch(action.type){\r\n            case \"CHANGE_ROOM\":\r\n                return action.payload\r\n        };\r\n    };\r\n\r\n    const [selectedRoom, dispatchSelectRoom] = useReducer(selectRoomReducer, INITIAL_SELECTED_ROOM);\r\n\r\n    return (\r\n        <DataProcessorContext.Provider value={{\r\n            currentUser: currentUser,\r\n            roommate: roommate,\r\n            selectedRoommate: selectedRoommate,\r\n            dispatchSelectRoommate,\r\n            favorite: favorite,\r\n            room: room,\r\n            selectedRoom: selectedRoom,\r\n            dispatchSelectRoom,\r\n            favoriteRoom: favoriteRoom\r\n        }}>\r\n            {children}\r\n        </DataProcessorContext.Provider>\r\n    );\r\n\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}