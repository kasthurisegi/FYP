{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { createContext, useEffect, useState, useReducer, useContext, useRef } from \"react\";\nimport { auth, db } from \"../../FirebaseConfig\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { doc, getDoc, onSnapshot, collection, query, where } from \"firebase/firestore\";\nimport { UserInfoContext } from \"./userInfoContext\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var DataProcessorContext = createContext();\nexport var DataProcessorContextProvider = function DataProcessorContextProvider(_ref) {\n  var children = _ref.children;\n\n  var _useContext = useContext(UserInfoContext),\n      userID = _useContext.userID;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      currentUser = _useState2[0],\n      setCurrentUser = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      roommate = _useState4[0],\n      setRoommate = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      room = _useState6[0],\n      setRoom = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      favorite = _useState8[0],\n      setFavorite = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      favoriteRoom = _useState10[0],\n      setFavoriteRoom = _useState10[1];\n\n  useEffect(function () {\n    if (userID) {\n      var unsub = onSnapshot(doc(db, \"users\", userID), function (doc) {\n        setCurrentUser(doc.data());\n        return;\n      });\n      var q = query(collection(db, \"favorite\"), where(\"userID\", \"==\", userID));\n      var unsubscribeFavorite = onSnapshot(q, function (querySnapshot) {\n        var favorites = [];\n        querySnapshot.forEach(function (doc) {\n          favorites.push(doc.data());\n        });\n        setFavorite(favorites);\n      });\n      var q1 = query(collection(db, \"favoriteRoom\"), where(\"userID\", \"==\", userID));\n      var unsubscribeRoomFavorite = onSnapshot(q1, function (querySnapshot) {\n        var favoritesRoom = [];\n        querySnapshot.forEach(function (doc) {\n          favoritesRoom.push(doc.data());\n        });\n        setFavoriteRoom(favoritesRoom);\n      });\n      return function () {\n        unsub, unsubscribeFavorite, unsubscribeRoomFavorite;\n      };\n    }\n  }, [userID]);\n  useEffect(function () {\n    var q = query(collection(db, \"roommates\"), where(\"roommateID\", \"!=\", \"\"));\n    var unsubscribeRoommate = onSnapshot(q, function (querySnapshot) {\n      var roommates = [];\n      querySnapshot.forEach(function (doc) {\n        roommates.push(doc.data());\n      });\n      setRoommate(roommates);\n    });\n    var q1 = query(collection(db, \"room\"), where(\"roomID\", \"!=\", \"\"));\n    var unsubscribeRoom = onSnapshot(q1, function (querySnapshot) {\n      var room = [];\n      querySnapshot.forEach(function (doc) {\n        room.push(doc.data());\n      });\n      setRoom(room);\n    });\n    return function () {\n      unsubscribeRoommate, unsubscribeRoom;\n    };\n  }, []);\n  var INITIAL_SELECTED_ROOMMATE = null;\n\n  var selectRoommateReducer = function selectRoommateReducer(state, action) {\n    switch (action.type) {\n      case \"CHANGE_ROOMMATE\":\n        return action.payload;\n    }\n\n    ;\n  };\n\n  var _useReducer = useReducer(selectRoommateReducer, INITIAL_SELECTED_ROOMMATE),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      selectedRoommate = _useReducer2[0],\n      dispatchSelectRoommate = _useReducer2[1];\n\n  var INITIAL_SELECTED_ROOM = null;\n\n  var selectRoomReducer = function selectRoomReducer(state, action) {\n    switch (action.type) {\n      case \"CHANGE_ROOM\":\n        return action.payload;\n    }\n\n    ;\n  };\n\n  var _useReducer3 = useReducer(selectRoomReducer, INITIAL_SELECTED_ROOM),\n      _useReducer4 = _slicedToArray(_useReducer3, 2),\n      selectedRoom = _useReducer4[0],\n      dispatchSelectRoom = _useReducer4[1];\n\n  return _jsx(DataProcessorContext.Provider, {\n    value: {\n      currentUser: currentUser,\n      roommate: roommate,\n      selectedRoommate: selectedRoommate,\n      dispatchSelectRoommate: dispatchSelectRoommate,\n      favorite: favorite,\n      room: room,\n      selectedRoom: selectedRoom,\n      dispatchSelectRoom: dispatchSelectRoom,\n      favoriteRoom: favoriteRoom\n    },\n    children: children\n  });\n};","map":{"version":3,"names":["React","createContext","useEffect","useState","useReducer","useContext","useRef","auth","db","onAuthStateChanged","doc","getDoc","onSnapshot","collection","query","where","UserInfoContext","DataProcessorContext","DataProcessorContextProvider","children","userID","currentUser","setCurrentUser","roommate","setRoommate","room","setRoom","favorite","setFavorite","favoriteRoom","setFavoriteRoom","unsub","data","q","unsubscribeFavorite","querySnapshot","favorites","forEach","push","q1","unsubscribeRoomFavorite","favoritesRoom","unsubscribeRoommate","roommates","unsubscribeRoom","INITIAL_SELECTED_ROOMMATE","selectRoommateReducer","state","action","type","payload","selectedRoommate","dispatchSelectRoommate","INITIAL_SELECTED_ROOM","selectRoomReducer","selectedRoom","dispatchSelectRoom"],"sources":["/Users/eason/Desktop/git-project/FYP/src/context/DataProcessor.js"],"sourcesContent":["\nimport React, { createContext, useEffect, useState, useReducer, useContext, useRef } from \"react\";\nimport { auth, db } from \"../../FirebaseConfig\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { doc, getDoc, onSnapshot, collection, query, where } from \"firebase/firestore\";\nimport { UserInfoContext } from \"./userInfoContext\";\n\nexport const DataProcessorContext = createContext();\n\nexport const DataProcessorContextProvider = ({ children }) => {\n\n    const { userID } = useContext(UserInfoContext);\n    const [currentUser, setCurrentUser] = useState(null);\n    const [roommate, setRoommate] = useState(null);\n    const [room, setRoom] = useState(null);\n    const [favorite, setFavorite] = useState(null);\n    const [favoriteRoom, setFavoriteRoom] = useState(null);\n\n    useEffect(() => {\n\n        if(userID){\n            const unsub = onSnapshot(doc(db, \"users\", userID), (doc) => {\n                setCurrentUser(doc.data())\n                return;\n            });\n\n            const q = query(collection(db, \"favorite\"), where(\"userID\", \"==\", userID));\n            const unsubscribeFavorite = onSnapshot(q, (querySnapshot) => {\n            const favorites = [];\n            querySnapshot.forEach((doc) => {\n                favorites.push(doc.data());\n            });\n            setFavorite(favorites)\n            });\n\n            const q1 = query(collection(db, \"favoriteRoom\"), where(\"userID\", \"==\", userID));\n            const unsubscribeRoomFavorite = onSnapshot(q1, (querySnapshot) => {\n            const favoritesRoom = [];\n            querySnapshot.forEach((doc) => {\n                favoritesRoom.push(doc.data());\n            });\n            setFavoriteRoom(favoritesRoom)\n            });\n\n            return () => {\n                unsub,\n                unsubscribeFavorite,\n                unsubscribeRoomFavorite\n            }\n        }\n\n    },[userID]);\n\n    useEffect(() => {\n\n        const q = query(collection(db, \"roommates\"), where(\"roommateID\", \"!=\", \"\"));\n        const unsubscribeRoommate = onSnapshot(q, (querySnapshot) => {\n        const roommates = [];\n        querySnapshot.forEach((doc) => {\n            roommates.push(doc.data());\n        });\n        setRoommate(roommates)\n        });\n\n        const q1 = query(collection(db, \"room\"), where(\"roomID\", \"!=\", \"\"));\n        const unsubscribeRoom = onSnapshot(q1, (querySnapshot) => {\n        const room = [];\n        querySnapshot.forEach((doc) => {\n            room.push(doc.data());\n        });\n        setRoom(room)\n        });\n\n        return () => {\n            unsubscribeRoommate,\n            unsubscribeRoom\n        }\n\n    },[]);\n\n    const INITIAL_SELECTED_ROOMMATE = null;\n\n    const selectRoommateReducer = (state, action) => {\n        switch(action.type){\n            case \"CHANGE_ROOMMATE\":\n                return action.payload\n        };\n    };\n\n    const [selectedRoommate, dispatchSelectRoommate] = useReducer(selectRoommateReducer, INITIAL_SELECTED_ROOMMATE);\n\n    const INITIAL_SELECTED_ROOM = null;\n\n    const selectRoomReducer = (state, action) => {\n        switch(action.type){\n            case \"CHANGE_ROOM\":\n                return action.payload\n        };\n    };\n\n    const [selectedRoom, dispatchSelectRoom] = useReducer(selectRoomReducer, INITIAL_SELECTED_ROOM);\n\n    return (\n        <DataProcessorContext.Provider value={{\n            currentUser: currentUser,\n            roommate: roommate,\n            selectedRoommate: selectedRoommate,\n            dispatchSelectRoommate,\n            favorite: favorite,\n            room: room,\n            selectedRoom: selectedRoom,\n            dispatchSelectRoom,\n            favoriteRoom: favoriteRoom,\n        }}>\n            {children}\n        </DataProcessorContext.Provider>\n    );\n\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}