{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { useNavigation } from '@react-navigation/native';\nimport { UserInfoContext } from \"../context/userInfoContext\";\nimport { storage } from \"../../FirebaseConfig\";\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\nimport * as ImagePicker from 'expo-image-picker';\nimport { DataProcessorContext } from \"../context/DataProcessor\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar EditProfile = function EditProfile() {\n  var _useContext = useContext(DataProcessorContext),\n      currentUser = _useContext.currentUser;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      image = _useState2[0],\n      setImage = _useState2[1];\n\n  function uploadImage(imageUri) {\n    var response, blobFile, reference, result, url;\n    return _regeneratorRuntime.async(function uploadImage$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(fetch(imageUri));\n\n          case 3:\n            response = _context.sent;\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(response.blob());\n\n          case 6:\n            blobFile = _context.sent;\n            reference = ref(storage, \"your_name.jpg\");\n            _context.next = 10;\n            return _regeneratorRuntime.awrap(uploadBytes(reference, blobFile));\n\n          case 10:\n            result = _context.sent;\n            _context.next = 13;\n            return _regeneratorRuntime.awrap(getDownloadURL(result.ref));\n\n          case 13:\n            url = _context.sent;\n            return _context.abrupt(\"return\", url);\n\n          case 17:\n            _context.prev = 17;\n            _context.t0 = _context[\"catch\"](0);\n            return _context.abrupt(\"return\", Promise.reject(_context.t0));\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 17]], Promise);\n  }\n\n  var pickImage = function _callee() {\n    var result;\n    return _regeneratorRuntime.async(function _callee$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.All,\n              allowsEditing: true,\n              aspect: [4, 3],\n              quality: 1\n            }));\n\n          case 2:\n            result = _context2.sent;\n\n            if (!result.cancelled) {\n              setImage(result.uri);\n              uploadImage(result.uri).then(function (url) {\n                console.log(url);\n              });\n            }\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return _jsxs(View, {\n    style: styles.container,\n    children: [image ? _jsx(Image, {\n      source: {\n        uri: image\n      },\n      resizeMode: \"cover\",\n      style: {\n        aspectRatio: 1,\n        width: '40%',\n        borderWidth: '2px',\n        borderRadius: '100%'\n      }\n    }) : _jsx(Image, {\n      resizeMode: \"cover\",\n      style: {\n        aspectRatio: 1,\n        width: '40%',\n        borderWidth: '2px',\n        borderRadius: '100%'\n      },\n      source: {\n        uri: currentUser == null ? void 0 : currentUser.userProfile\n      }\n    }), _jsx(Button, {\n      title: \"Choose an Image\",\n      onPress: pickImage\n    }), _jsx(View, {\n      style: styles.content\n    })]\n  });\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    height: '100%',\n    width: '100%',\n    overflow: 'scroll',\n    display: \"flex\",\n    paddingTop: \"20px\",\n    paddingBottom: '20px',\n    alignItems: 'center',\n    gap: 20\n  },\n  flexDirection: {\n    flexDirection: 'row',\n    gap: 15\n  },\n  content: {\n    paddingVertical: '10px'\n  }\n});\nexport default EditProfile;","map":{"version":3,"names":["React","useState","useEffect","useContext","useNavigation","UserInfoContext","storage","ref","uploadBytes","getDownloadURL","ImagePicker","DataProcessorContext","EditProfile","currentUser","image","setImage","uploadImage","imageUri","fetch","response","blob","blobFile","reference","result","url","Promise","reject","pickImage","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","cancelled","uri","then","console","log","styles","container","aspectRatio","width","borderWidth","borderRadius","userProfile","content","StyleSheet","create","flex","height","overflow","display","paddingTop","paddingBottom","alignItems","gap","flexDirection","paddingVertical"],"sources":["/Users/eason/Desktop/git-project/FYP/src/containers/EditProfile.js"],"sourcesContent":["import { View, Text, StyleSheet, Image, TouchableOpacity, Button } from 'react-native'\nimport React, {useState, useEffect, useContext} from 'react'\nimport { useNavigation } from '@react-navigation/native'\nimport { UserInfoContext } from '../context/userInfoContext'\nimport { storage } from '../../FirebaseConfig'\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage'\nimport * as ImagePicker from 'expo-image-picker';\nimport { DataProcessorContext } from '../context/DataProcessor'\n\nconst EditProfile = () => {\n\n    const { \n        currentUser\n      } = useContext(DataProcessorContext);\n\n    const [image, setImage] = useState(null);\n\n    async function uploadImage(imageUri) {\n        try {\n          const response = await fetch(imageUri)\n          const blobFile = await response.blob()\n      \n          const reference = ref(storage, \"your_name.jpg\")\n          const result = await uploadBytes(reference, blobFile)\n          const url = await getDownloadURL(result.ref)\n      \n          return url\n        } catch (err) {\n          return Promise.reject(err)\n      }\n    }\n\n  const pickImage = async () => {\n    // No permissions request is necessary for launching the image library\n    let result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.All,\n      allowsEditing: true,\n      aspect: [4, 3],\n      quality: 1,\n    });\n\n    if (!result.cancelled) {\n      setImage(result.uri);\n      uploadImage(result.uri).then(url => {\n        console.log(url)\n      })\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n        {image ? \n            <Image source={{ uri: image }} resizeMode='cover' style={{aspectRatio: 1, width: '40%', borderWidth: '2px', borderRadius: '100%' }}/>\n                :\n            <Image resizeMode='cover' style={{aspectRatio: 1, width: '40%', borderWidth: '2px', borderRadius: '100%' }} source={{\n            uri: currentUser?.userProfile\n            }}/>\n        }\n        <Button title=\"Choose an Image\" onPress={pickImage} />\n        <View style={styles.content}>\n\n        </View>\n\n      \n    </View>\n  );\n\n\n\n}\n\nconst styles = StyleSheet.create({\n\n    container: {\n        flex: 1,\n        height:'100%',\n        width:'100%',\n        overflow: 'scroll',\n        display: \"flex\",\n        paddingTop: \"20px\",\n        paddingBottom: '20px',\n        alignItems: 'center',\n        gap: 20\n      },\n    \n      flexDirection: {\n        flexDirection: 'row',\n        gap: 15,\n      },\n\n      content: {\n        paddingVertical: '10px',\n        \n      }\n    \n  })\n  \n\nexport default EditProfile;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}